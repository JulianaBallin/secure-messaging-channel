# ğŸ§© Mapeamento de ImplementaÃ§Ã£o â€” Canal de ComunicaÃ§Ã£o Seguro (Python + IDEA + RSA)

> âš ï¸ Status geral: todos os mÃ³dulos estÃ£o **parcialmente implementados**, com base funcional jÃ¡ existente.  
> Cada responsÃ¡vel deve revisar, otimizar e completar o cÃ³digo conforme descrito abaixo.

---

## ğŸ‘©â€ğŸ’» Pessoa 1 â€” Criptografia e SeguranÃ§a

### ğŸ§± Caminhos e status

- **Criptografia simÃ©trica IDEA (modo CBC + PKCS7)**  
  ğŸ“‚ `backend/crypto/idea_manager.py`  
  â¤ ImplementaÃ§Ã£o funcional com logs e fallback automÃ¡tico.  
  â¤ NecessÃ¡rio testar novamente apÃ³s reinstalaÃ§Ã£o do IDEA nativo (`pycryptodomex`).  

- **Fallback Python puro (IDEA)**  
  ğŸ“‚ `backend/crypto/idea_fallback.py`  
  â¤ ImplementaÃ§Ã£o completa, mas precisa revisÃ£o da funÃ§Ã£o `decrypt()` (erro de padding).  
  â¤ Testar compatibilidade total com `idea_manager.py`.  

- **Criptografia assimÃ©trica RSA (PKCS1_OAEP)**  
  ğŸ“‚ `backend/crypto/rsa_manager.py`  
  â¤ Implementado com funÃ§Ãµes `generate_rsa_keypair()`, `encrypt_with_rsa()`, `decrypt_with_rsa()`.  
  â¤ Falta revisar integraÃ§Ã£o com `signup_cli.py` e armazenamento de chaves RSA no banco.  

- **Autoteste `verify_encryption_cycle()`**  
  ğŸ“‚ `backend/crypto/idea_manager.py`  
  â¤ Implementado, mas retorna erro de padding no fallback.  
  â¤ Requer correÃ§Ã£o da funÃ§Ã£o `decrypt_message()` no fallback.  

- **Hash seguro de senhas (bcrypt/passlib)**  
  ğŸ“‚ `backend/auth/security.py`  
  â¤ Implementado parcialmente â€” utiliza `passlib` com hash e verificaÃ§Ã£o.  
  â¤ Verificar se o mesmo hash Ã© usado em `handlers.py` e `login_cli.py`.  

- **Logs de seguranÃ§a (`logs/crypto.log`)**  
  ğŸ“‚ `backend/utils/logger_config.py`  
  â¤ Loggers configurados (`crypto_logger` ativo).  
  â¤ Revisar para incluir logs de exceÃ§Ãµes e falhas de integridade.  

- **Compatibilidade com o servidor e fallback automÃ¡tico**  
  ğŸ“‚ `backend/crypto/idea_manager.py` e `backend/server/handlers.py`  
  â¤ Parcialmente implementado â€” IDEA com fallback ativo e RSA funcional.  
  â¤ Verificar integraÃ§Ã£o E2EE no fluxo `send_message()`.

---

## ğŸ§  Pessoa 2 â€” Servidor e ComunicaÃ§Ã£o (Backend)

### ğŸ§± Caminhos e status

- **Servidor assÃ­ncrono com TLS**  
  ğŸ“‚ `backend/server/server.py`  
  â¤ Implementado e funcional, usa asyncio + TLS com certificados automÃ¡ticos.  
  â¤ Falta revisÃ£o de reconexÃ£o (`resume_session`) e tratamento de erros SSL.  

- **Manipuladores (`handlers.py`)**
  ğŸ“‚ `backend/server/handlers.py`  
  â¤ `register`, `login`, `list_users`, `send_message` implementados.  
  â¤ `group_message` ainda nÃ£o implementado.  
  â¤ Adicionar logs detalhados para cada aÃ§Ã£o e auditoria de chaves.  

- **Bloqueio global `USERS_LOCK`**  
  ğŸ“‚ `backend/server/handlers.py`  
  â¤ Implementado corretamente para evitar race conditions.  
  â¤ Testar com mÃºltiplas conexÃµes simultÃ¢neas.  

- **Mensagens offline e reconexÃ£o**
  ğŸ“‚ `backend/server/handlers.py`  
  â¤ Entrega offline implementada, mas testar se mensagens persistem corretamente no banco.  
  â¤ Falta lÃ³gica de restauraÃ§Ã£o de sessÃ£o (`resume_session`).  

- **Logs do servidor (`logs/server.log`)**  
  ğŸ“‚ `backend/utils/logger_config.py`  
  â¤ Loggers ativos e configurados.  
  â¤ Adicionar logs de handshake TLS, falhas de autenticaÃ§Ã£o e conexÃµes encerradas.

---

## ğŸ’¾ Pessoa 3 â€” Banco de Dados e PersistÃªncia (JUJUBA)

### ğŸ§± Caminhos e status

- **Banco SQLite com SQLAlchemy**
  ğŸ“‚ `backend/database/connection.py`  
  â¤ Implementado, cria o engine e gerencia a sessÃ£o.  
  â¤ Revisar `ensure_database()` para confirmar criaÃ§Ã£o de tabelas automÃ¡ticas.  

- **Modelagem de tabelas**
  ğŸ“‚ `backend/auth/models.py`  
  â¤ Tabelas `User` e `Message` implementadas.  
  â¤ Falta `Group` e `GroupMembers`.  

- **Consultas e funÃ§Ãµes**
  ğŸ“‚ `backend/database/queries/`  
  â¤ Arquivos `users.py` e `messages.py` contÃªm consultas bÃ¡sicas.  
  â¤ Adicionar funÃ§Ãµes para histÃ³rico, grupos e mensagens pendentes.  

- **HistÃ³rico criptografado**
  ğŸ“‚ `backend/server/handlers.py` + `backend/database/messages.py`  
  â¤ Parcialmente implementado (mensagens armazenadas cifradas).  
  â¤ Falta descriptografia automÃ¡tica no recebimento.  

- **Logs de banco**
  ğŸ“‚ `backend/utils/logger_config.py`  
  â¤ Logger `database_logger` ainda nÃ£o existe â€” criar para `logs/database.log`.  

---

## ğŸ’¬ Pessoa 4 â€” Interface CLI e ExperiÃªncia do UsuÃ¡rio

### ğŸ§± Caminhos e status

- **CLI principal (`run_cli.py`)**
  ğŸ“‚ `run_cli.py` (raiz do projeto)  
  â¤ Implementado com menus e subfunÃ§Ãµes (login, envio, leitura).  
  â¤ Falta limpar terminal apÃ³s cada aÃ§Ã£o e centralizar logs.  

- **AutenticaÃ§Ã£o (`client/auth/`)**
  ğŸ“‚ `client/auth/signup_cli.py` e `client/auth/login_cli.py`  
  â¤ Ambos funcionais com TLS, mas sem tratamento de erros detalhado.  
  â¤ Verificar integraÃ§Ã£o RSA no cadastro e JWT no login.  

- **Envio e recebimento de mensagens**
  ğŸ“‚ `backend/messages/cli.py`  
  â¤ Implementado parcialmente com E2EE.  
  â¤ Corrigir handshake TLS e leitura de respostas JSON.  
  ğŸ“‚ `backend/messages/listener.py`  
  â¤ Listener funcional, falta reconexÃ£o automÃ¡tica e logs independentes.  

- **Mensagens offline**
  ğŸ“‚ `backend/server/handlers.py` e `backend/messages/cli.py`  
  â¤ Parcialmente implementado (armazenamento no banco).  
  â¤ Falta leitura automÃ¡tica no login.  

- **Lista de contatos**
  ğŸ“‚ `backend/messages/cli.py`  
  â¤ Implementado parcialmente via `list_users`.  
  â¤ Precisa atualizaÃ§Ã£o em tempo real com listener.  

- **Logs de aÃ§Ãµes do cliente (`logs/messages.log`)**
  ğŸ“‚ `backend/utils/logger_config.py`  
  â¤ Logger `messages_logger` ativo.  
  â¤ Falta integraÃ§Ã£o direta nos scripts CLI.

---

## ğŸ§­ ConclusÃ£o â€” Caminho para FinalizaÃ§Ã£o

| Ãrea | Arquivo-chave | Status | PrÃ³ximos passos |
|------|----------------|---------|----------------|
| IDEA / RSA | `backend/crypto/idea_manager.py` | âš ï¸ Parcial | Corrigir fallback e testar com IDEA nativo |
| Servidor | `backend/server/server.py` | âš™ï¸ Funcional | Revisar reconexÃ£o e TLS persistente |
| Banco de Dados | `backend/auth/models.py` | âš ï¸ Incompleto | Adicionar tabelas de grupos e histÃ³rico |
| CLI | `run_cli.py` | âš™ï¸ Funcional | Melhorar UX e logs no terminal |
| Logs | `backend/utils/logger_config.py` | âœ… Ativo | Criar `database_logger` e revisar formato JSON |

---

